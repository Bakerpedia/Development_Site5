/*! EasyRecipe Plus 3.3.3077 Copyright (c) 2015 BoxHill LLC */
!function(e){function t(t,a){var o,r,i=0;for(o=0;o<a.length;o++)r=b[a[o].id],"OK"===r.status&&(i+=r.nRecipes);e("#spnERSnImportRecipes").html(i),e("#spnERSnImportFiles").html(a.length),l.hide(),d.show()}function a(t,a,o){b[a.id]=e.parseJSON(o.response)}function o(){h.hide()}function r(){var r;switch(x&&(l.plupload("destroy"),c.html("")),r=e("#divERSImportFormats").find('input[name="rbERSImportSource"]:checked').val()){case"paprika":u=[{title:"Paprika (*.paprikarecipe)",extensions:"paprikarecipe"}];break;case"paprikas":u=[{title:"Paprika (*.paprikarecipes)",extensions:"paprikarecipes"}];break;case"mealmaster":u=[{title:"Meal-Master Format (*.mmf, *.mxp)",extensions:"mmf,mxp"}];break;case"mastercook":u=[{title:"MC 5+ Format (*.mx2)",extensions:"mx2"}];break;case"mastercookmxp":u=[{title:"Older MasterCook Format (*.mxp)",extensions:"mxp"}];break;case"yummysoup":u=[{title:"Yummy Soup Format (*.xml)",extensions:"xml"}];break;case"macgourmet":u=[{title:"MacGourmet Format (*.mgourmet3, *.mgourmet4)",extensions:"mgourmet3, mgourmet4"}];break;case"cookn":u=[{title:"Cook'n HTML (*.html)",extensions:"html"}];break;case"cookbookwiz":u=[{title:"Cookbook Wizard text (*.txt)",extensions:"txt"}];break;default:u=[]}l=e("#divERSImportUploader").plupload({runtimes:"html5,flash,silverlight,html4",url:ajaxurl,multipart_params:{action:"easyrecipeImport",source:r},filters:u,max_file_size:"40mb",chunk_size:"1mb",unique_names:!0,flash_swf_url:f.wpurl+"/wp-includes/js/plupload/plupload.flash.swf",silverlight_xap_url:f.wpurl+"/wp-includes/js/plupload/plupload.silverlight.xap"}),x=l.plupload("getUploader"),x.bind("UploadComplete",t),x.bind("FileUploaded",a),x.bind("BeforeUpload",o)}function i(){e("#divERSImportConfirm").hide(),l.plupload("destroy"),c.html(""),m.attr("checked",!1),x=null}function p(e){"OK"===e.status&&window.location.replace(f.editURL)}function s(){}function n(t){var a,o=[];switch(t.target.id){case"btnERSImportCreate":i(),h.hide(),d.hide(),k.show();for(a in b)b.hasOwnProperty(a)&&o.push(b[a].file);e.ajax(ajaxurl,{dataType:"json",data:{action:"easyrecipeCreate",files:o},type:"POST",success:p,error:s});break;case"btnERSImportCancel":i(),h.show(),d.hide()}}var l,m,u,c,d,h,k,f,x=null,b={};e(function(){var t;f=EASYRECIPE,t=e("#divERSImportButtons").on("click",n),e('input[type="button"]',t).button(),m=e("#divERSImportFormats").find('input[name="rbERSImportSource"]').on("change",r),c=e("#divERSImportUploader"),d=e("#divERSImportConfirm").hide(),h=e("#divERSImportSettings"),k=e("#divERSImportCreating").hide()})}(jQuery);