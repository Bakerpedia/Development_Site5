/*! EasyRecipe Plus 3.3.3077 Copyright (c) 2015 BoxHill LLC */
window.EASYRECIPE=window.EASYRECIPE||{},EASYRECIPE.widget=EASYRECIPE.widget||jQuery.widget,EASYRECIPE.button=EASYRECIPE.button||jQuery.fn.button,function(e){function t(e,t){var i;switch(Me.show(),vt.hide(),Ue.show(),i=t.newTab?t.newTab.index():t.index){case 0:vt.css("right","10px"),vt.show();break;case 3:vt.css("right","inherit"),Ue.hide(),vt.show();break;case 4:Me.hide()}}function i(){Rt.off("change",i),ui=!0}function n(e){return e?(e+="",e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," ")):""}function a(t){return t?e("<div />").text(t).html():""}function r(t){return e.trim(a(t.val()))||!1}function s(e,t){var i=Pe.tabs("option","active");Pe.tabs("option","active",++i)}function l(e){var t,i=/\[img +(.*?) *\/?]/i,n=/\[url ([^\]]+)](.*?\[\/url])/i,a=/\[cap ([^\]]+)](.*])(.*?)\[\/cap]/i;if(""!==e){for(t=i.exec(e);null!==t;)Ft.push(t[1].replace(/</g,"&lt;").replace(/>/g,"&gt;")),e=e.replace(i,"[img:"+Ft.length+"]"),t=i.exec(e);for(t=n.exec(e);null!==t;)jt.push(t[1]),e=e.replace(n,"[url:"+jt.length+"]$2"),t=n.exec(e);for(t=a.exec(e);null!==t;)zt.push(t[1]),$t.push(t[3].replace(/</g,"&lt;").replace(/>/g,"&gt;")),e=e.replace(a,"[cap:"+zt.length+"]$2[/cap]"),t=a.exec(e)}return e}function o(e){var t,i,n,a=/\[img:(\d+)]/i,r=/\[url:(\d+)](.*?)\[\/url]/i,s=/\[cap:(\d+)](.*])\[\/cap]/i;if(e){for(n=a.exec(e);null!==n;)t=Ft[n[1]-1].replace(/&quot;/g,"&amp;quot;"),e=e.replace(a,"[img "+t+"]"),n=a.exec(e);for(n=r.exec(e);null!==n;)t=jt[n[1]-1],e=e.replace(r,"[url "+t+"]$2[/url]"),n=r.exec(e);for(n=s.exec(e);null!==n;)t=zt[n[1]-1],i=$t[n[1]-1],e=e.replace(s,"[cap "+t+"]$2"+i+"[/cap]"),n=r.exec(e)}return e}function c(e,t){var i,n,a,r,s,l,o,d,u,p,h,f,v,m,g,y,E,b,R,w,k,C,T,x,I,S=0,N=1,_=2,A=0,L="",D="<!-- START REPEAT ",P="<!-- START INCLUDEIF ",M="<!-- END INCLUDEIF ";for(i=e,t=t||{};;){if(s=i.length,l=i.indexOf("#",A),-1!==l&&(s=l,o=S),d=i.indexOf(D,A),-1!==d&&s>d&&(s=d,o=N),u=i.indexOf(P,A),-1!==u&&s>u&&(s=u,o=_),s===i.length)return L+i.substr(A);switch(p=s-A,L+=i.substr(A,p),A=s,o){case _:if(a=i.substr(A,44),r=Tt.exec(a),null===r)break;if(h=r[1],f="!"!==h,v=r[2],m=M+h+v+" -->",g=m.length,y=i.indexOf(m),-1===y){A++;break}E=typeof t[v]!==ti&&t[v]!==!1,E===f?(b="<!-- START INCLUDEIF "+h+v+" -->",R=b.length,i=i.substr(0,A)+i.substr(A+R,y-A-R)+i.substr(y+g)):i=i.substr(0,A)+i.substr(y+g);break;case S:if(a=i.substr(A,22),r=xt.exec(a),null===r){L+="#",A++;continue}if(w=r[1],""!==t[w]&&!t[w]){L+="#"+w+"#",A+=w.length+2;continue}L+=t[w],A+=w.length+2;break;case N:if(a=i.substr(A,45),r=It.exec(a),null===r){L+="<",A++;continue}if(k=r[1],!(t[k]&&t[k]instanceof Array)){L+="<",A++;continue}if(A+=k.length+22,C=i.indexOf("<!-- END REPEAT "+k+" -->",A),-1===C){L+="<!-- START REPEAT "+k+" -->";continue}for(T=C-A,x=i.substr(A,T),I=t[k],n=0;n<I.length;n++)L+=c(x,I[n]);A+=k.length+T+20}}}function d(t){var i,n,a=e.trim(t.val()),r=0,s=0;if(de.hide(),""===a)return!0;if(De=Nt.exec(a),null===De){if(De=_t.exec(a),null===De)return de.show(),!1;r=0,s=De[1]}else r=De[1]?parseInt(De[1],10):0,s=De[2]?parseInt(De[2],10):0;return 0===r&&0===s?t.val(""):(i=r>0?r+" hour":"",r>1&&(i+="s"),n=s>0?s+" min":"",s>1&&(n+="s"),t.val(e.trim(i+" "+n))),!0}function u(t){var i,n,a,r="";for(i=0;i<t.length;i++)n=t[i],3!==n.nodeType?1===n.nodeType&&n.childNodes.length>0&&(r+=u(n.childNodes)):(a=e.trim(n.nodeValue),""!==a&&(r+=a+"\n"));return r}function p(){var t;if(e(Gt,Qt).remove(),t=J.selection.getNode(),"#document"===t.nodeName&&(t=Ae[0]),"BODY"===t.nodeName.toUpperCase())e(t).hasClass("mceContentBody")||(t=Ae[0]),/^<p><br[^>]*><\/p>$/.test(t.innerHTML)?e(t).prepend(Vt):e(t).append("&nbsp;"+Vt);else{for(;t.parentNode&&"BODY"!==t.parentNode.nodeName.toUpperCase();)t=t.parentNode;t.parentNode?"DIV"===t.nodeName.toUpperCase()||"SPAN"===t.nodeName.toUpperCase()?e(t,Qt).after(Vt):e(t,Qt).before(Vt):(t=Ae[0],e(t).append("&nbsp;"+Vt))}return dt=-1,e(Gt,Qt)}function h(e,t,i){}function f(t){switch(t.type){case"js":e("head").append(e('<script type="text/javascript">'+t.js+"</script>")),Te[t.f]();break;case"html":e(t.dest).html(t.html)}}function v(){Fe.unbind(ei),ze.unbind(ei),_e.dialog(Xt),Ct=!0,ye()}function m(t,i){var a,r,s,l="";for(r=t.recipe,"success"!==i&&(_e.dialog(Xt),Ct=!0,ye()),Z.val(n(r.recipe_title)),r.rating&&e.isNumeric(r.rating)&&K.val(r.rating),oi=r.recipe_image,le.val(""),se.val(r.author?n(r.author):""),oe.val(r.cuisine||""),le.val(r.mealType||""),ce.val(""),X.val(n(r.summary)),De=Pt.exec(r.prep_time),null!==De?(a=De[1]?De[1]+"h ":"",ie.val(a+De[2]+"m")):ie.val(n(r.prep_time)),De=Pt.exec(r.cook_time),null!==De?(a=De[1]?De[1]+"h ":"",ne.val(a+De[2]+"m")):ne.val(n(r.cook_time)),ae.val(n(r["yield"])),Qe.val(n(r.serving_size)),r.nutrition?(s=r.nutrition,Ke.val(n(s.calories)),Ze.val(n(s.totalFat)),Xe.val(n(s.saturatedFat)),et.val(n(s.unsaturatedFat)),tt.val(n(s.transFat)),it.val(n(s.totalCarbohydrates)),nt.val(n(s.sugars)),at.val(n(s.sodium)),rt.val(n(s.dietaryFiber)),st.val(n(s.protein)),lt.val(n(s.cholesterol))):(Ke.val(n(r.calories)),Ze.val(n(r.fat))),a=0;a<t.ingredients.length;a++)l+=kt(n(t.ingredients[a]))+"\n";ee.val(l),te.val(n(r.instructions.replace("\r",""))),ot.val(n(r.notes)),Ie.easyrecipeDialog("option","title","Update Recipe"),_e.dialog(Xt),$e.hide(),Be.show(),qe.hide(),""!==oi&&Et(oi,He.length,!0),pe=p(),Ie.easyrecipeDialog(ii)}function g(){var t;je.show(),Fe.unbind(ei),ze.unbind(ei),t={action:"easyrecipeConvert",id:me,type:ge},e.post(ajaxurl,t,m,"json")}function y(t){var i,n,a,r,s,l,o,c,d,p,h,f,v,m=0,g="",y="",E="",b="",R=["instruction","method","cooking method","procedure","direction"],w=["ingredients?"],k=["note","cooking note"];for(h=e.parseJSON(Te.ingredients),f=e.parseJSON(Te.instructions),v=e.parseJSON(Te.notes),-1===e.inArray(h,w)&&w.push(h),l="^\\s*(?:"+w.join("|")+")",d=new RegExp(l,"i"),-1===e.inArray(f,R)&&w.push(f),s="^\\s*(?:"+R.join("|")+")",c=new RegExp(s,"i"),-1===e.inArray(v,k)&&k.push(v),o="^\\s*(?:"+k.join("|")+")\\s*$",p=new RegExp(o,"i"),r=e("<div>"+t+"</div>"),i=u(r[0].childNodes),i=i.split("\n"),n=0;n<i.length;n++)if(a=e.trim(i[n]),""!==a)if(c.test(a))m=2;else if(d.test(a))m=1;else if(p.test(a))m=3;else switch(m){case 0:g+=a+"\n";break;case 1:y+=a+"\n";break;case 2:E+=a+"\n";break;case 3:b+=a+"\n"}return{summary:g,ingredients:y,instructions:E,notes:b}}function E(t){var i,n=e(".easyrecipe",Qt),a=e("#divERSELRecipes").find("ul");a.empty(),n.each(function(n){i=e(".ERName",this).text(),""===i&&(i="Recipe "+(n+1)),a.append(e("<li>"+i+"</li>").click(function(){Ne.dialog(Xt),Ee(t,n)}))}),Ne.dialog(ii)}function b(t,i,n){var a,r=function(){var t,i,n,a,r=e.data(this,"index");t=this.width/150,i=this.height/112,t=t>i?t:i,n=Math.floor(this.height/t),a=Math.floor(this.width/t),He[r].height(n),He[r].width(a),He[r].css("top",(112-n)/2),He[r].attr("src",this.src),0===r&&e("#ERDTabs").find(".divERNoPhotos").remove()};Oe.append('<div class="ERPhoto"><img style="position:relative" id="ERPhoto_'+i+'" /></div>'),He[i]=e("#ERPhoto_"+i,Oe),He[i].data("src",t),n&&(e(".ERPhoto",Oe).removeClass(ni),He[i].parent().addClass(ni),ht=i,oi=t),""===gt&&(gt=t),a=new Image,e.data(a,"index",i),a.onload=r,a.src=t}function R(){b(pt.val(),He.length,!0),pt.val(""),ut.hide(),e(".divERNoPhotos").remove()}function w(e,t){var i,n=!1;for(i=0;i<He.length;i++)if(He[i].data("src")===e){n=!0;break}n||b(e,He.length,t)}function k(t,a){var r,s,o,c,d,u,m,R,k,C,T,x,I,S,N,_,A,L,D,P=!1,M=!1,U={},H="",O="",q="",j="";if(!t||1===t.which){if(t&&t.data===li&&(a=li,t=t.delegateTarget),typeof a===ti&&Kt>1)return Kt=e(".easyrecipe",Qt).length,void E(t);if(pe=e(".easyrecipe",Qt),a===li){for(R=0;R<pe.length;R++)if(pe[R]===t){dt=R;break}pe=e(t)}if(typeof a===ti&&typeof t===ti&&(dt=0),a!==si&&pe.length>1&&(pe=e(pe[a]),dt=a),o=0,o=1,I=e.support.cors?"json":"jsonp",e.ajax(ai,{dataType:I,data:{v:Te.version,p:o,u:Te.wpurl},success:f,error:h}),Q=!1,typeof tinyMCE!==ti&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()&&(Q=!0),!Q)return void alert("You must use the Visual Editor to add or update an EasyRecipe");if(Z.val(""),le.val(""),oe.val(""),ce.val(""),se.val(""),X.val(""),ie.val(""),ne.val(""),ae.val(""),ee.val(""),te.val(""),Qe.val(""),Ke.val(""),Ze.val(""),Xe.val(""),et.val(""),tt.val(""),it.val(""),nt.val(""),at.val(""),rt.val(""),st.val(""),lt.val(""),ot.val(""),a!==si&&1===pe.length)Ie.easyrecipeDialog("option","title","Update Recipe"),qe.hide(),$e.hide(),Be.show(),he=!0;else{if(ue=J.getContent(),!Ct&&(T=At.exec(ue)||Lt.exec(ue)||Dt.exec(ue),T||(P=e("#hasRecipe").is(":checked")),T||P||(s=Qt.find(".hrecipe").filter(".f1",".f2"),s.length>0&&(M=-1!==s.text().indexOf("recipage.com"))),T||P||M))return P?(ge="recipress",me=Te.postID):M?(ge="recipage",me=Te.postID):(ge=T[2],me=T[3]),je.hide(),Fe.click(v),ze.click(g),m=qt[ge],C=e("#txtERCNVText1",_e),C.html(C.html().replace("#plugin#",m)),Oe.html(""),ht=-1,He=[],Oe.html(ri),void _e.dialog(ii);Te.isGuest&&(A=e("#inpERAuthor").val()||"",se.val(A)),$e.show(),Be.hide(),qe.show(),Ie.easyrecipeDialog("option","title","Add a New Recipe"),he=!1,be!==!1?U=y(be):(_=J.selection.getContent(),_.length>20&&(U=y(_))),U.summary&&(H=U.summary),U.ingredients&&(O=U.ingredients),U.instructions&&(q=U.instructions),U.notes&&(j=U.notes),pe=p()}for(pe.find(".hiddenGrammarError, .hiddenSpellError, .hiddenSuggestion").each(function(){var t;e(this).parent(".mceItemHidden").length>0&&e(this).unwrap(),t=e(this).text(),e(this).replaceWith(t)}),L=pe,pe=e("<div>"+pe.html()+"</div>"),e("#inpERCuisine").autocomplete({source:e.parseJSON(Te.cuisines)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />'),e("#inpERType").autocomplete({source:e.parseJSON(Te.recipeTypes)}).autocomplete("widget").wrap('<div class="easyrecipeUI" />'),ui=!1,Rt.off("change",i).on("change",i),mt=a!==si?pe.find(".endeasyrecipe").text():Te.version,""===mt&&(mt="2.2"),r=!!pe.find("div.endeasyrecipe").attr("title"),oi=e('link[itemprop="image"]',pe).attr("href")||"",Oe.html(""),ht=-1,gt="",He=[],Qt.find("img").each(function(t){var i=!1;"3">mt?e(this).hasClass("photo")&&(i=!0):i=this.src===oi,b(this.src,t,i)}),u=Qt.contents().text(),T=Mt.exec(u),S=He.length;null!==T;)d=Ht.exec(T[0]),null!==d&&(c=d[1],b(c,S),mt>"3"?oi===c&&(He[S].parent().addClass(ni),ht=S):Ut.test(T[0])&&(He[S].parent().addClass(ni),ht=S,oi=c),S++),T=Mt.exec(u);""!==oi&&w(oi,!0),ve=e("#set-post-thumbnail").find("img").attr("src"),ve&&w(ve,-1===ht),-1===ht&&He.length>0&&(ht=0,oi=gt,He[0].parent().addClass(ni)),Oe.click(function(t){"IMG"===t.target.nodeName&&(e(".ERPhoto",Oe).removeClass(ni),e(t.target).parent().addClass(ni),oi=t.target.src)}),0===He.length?Oe.html(ri):-1===ht&&He[0].parent().addClass(ni),Ft=[],jt=[],N=pe.find(".ERName .fn").html()||pe.find(".ERName").html(),Z.val(N&&""!==N?l(n(N)):l(n(e("#title").val()))),le.val(l(n(pe.find(".type").html()))),se.val(l(n(pe.find(".author").html()))),""===se.val()&&se.val(l(e.parseJSON(Te.author))),oe.val(l(n(pe.find(".cuisine").html()))),X.val(l(H+n(pe.find(".summary").html()))),r&&X.val(l(n(pe.find(".ERSSummary").html()))),mt>"3"?(x=pe.find('time[itemprop="prepTime"]').html()||"",ie.val(n(x)),x=pe.find('time[itemprop="cookTime"]').html()||"",ne.val(n(x))):(x=pe.find(".preptime").html()||"",T=St.exec(x),ie.val(null!==T?n(T[1]):""),x=pe.find(".cooktime").html()||"",T=St.exec(x),ne.val(null!==T?n(T[1]):"")),ae.val(n(pe.find(".yield").html())),pe.find(".ingredients li").each(function(t,i){O+=e(i).hasClass(Jt)?"!"+l(n(i.innerHTML))+"\n":l(n(i.innerHTML))+"\n"}),r&&""===O&&pe.find(".ingredient,.ERSIngredients .ERSSectionHead").each(function(t,i){O+=e(i).hasClass("ERSSectionHead")?"!"+l(n(i.innerHTML))+"\n":l(n(i.innerHTML))+"\n"}),ee.val(O),pe.find(".instructions li, .instructions .ERSeparator").each(function(t,i){k=e.trim(i.innerHTML.replace(/^[ 0-9.]*(.*)$/gi,"$1")),q+=e(i).hasClass(Jt)?"!"+k+"\n":k+"\n"}),r&&""===q&&pe.find(".instruction,.ERSInstructions .ERSSectionHead").each(function(t,i){k=e.trim(i.innerHTML.replace(/^[ 0-9.]*(.*)$/gi,"$1")),q+=e(i).hasClass("ERSSectionHead")?"!"+k+"\n":k+"\n"}),te.val(l(n(q))),Qe.val(n(pe.find(".servingSize").html())),Ke.val(n(pe.find(".calories").html())),Ze.val(n(pe.find(".fat").html())),Xe.val(n(pe.find(".saturatedFat").html())),et.val(n(pe.find(".unsaturatedFat").html())),tt.val(n(pe.find(".transFat").html())),it.val(n(pe.find(".carbohydrates").html())),nt.val(n(pe.find(".sugar").html())),at.val(n(pe.find(".sodium").html())),rt.val(n(pe.find(".fiber").html())),st.val(n(pe.find(".protein").html())),lt.val(n(pe.find(".cholesterol").html())),D=L.parent().prop("data-rating"),K.val(e.isNumeric(D)?D:"5"),k=(n(pe.find(".ERNotes").html())||"").replace(/<\/p>\n*<p>/gi,"\n\n").replace(/(?:<p>|<\/p>)/gi,"").replace(/<br *\/?>/gi,"\n"),""===k&&""!==j&&(k=j),k=l(k),k=k.replace(/\[br(?: ?\/)?]/gi,"\n"),ot.val(l(k)),r&&""===k&&(k=(n(pe.find(".ERSNotes").html())||"").replace(/<\/p>\n*<p>/gi,"\n\n").replace(/(?:<p>|<\/p>)/gi,"").replace(/<br *\/?>/gi,"\n"),""===k&&""!==j&&(k=j),k=l(k),k=k.replace(/\[br(?: ?\/)?]/gi,"\n"),k=k.replace(/ data-mce-href="[^"]+?"/gi,""),k=k.replace(/<a ([^>]+?)>([^<]+?)<\/a>/gi,"[url $1]$2[/url]"),ot.val(l(k))),bt&&(bt.name&&Z.val(l(n(bt.name))),bt.author&&se.val(l(bt.author)),bt.summary&&X.val(l(bt.summary)),bt["yield"]&&ae.val(n(bt["yield"])),bt.type&&le.val(l(n(bt.type))),bt.cuisine&&oe.val(l(n(bt.cuisine))),bt.prepTime&&ie.val(n(bt.prepTime)),bt.cookTime&&ne.val(n(bt.cookTime)),bt.summary&&X.val(l(bt.summary))),pe=L,Ie.easyrecipeDialog(ii),Ie.easyrecipeDialog("option","position","center")}}function C(t){return Kt=e(".easyrecipe",Qt).length,Zt||0===Kt?void k(t,si):void Se.dialog(ii)}function T(){Ie.easyrecipeDialog(Xt)}function x(){Ne.dialog(Xt)}function I(){var e=confirm("Are you sure you want to delete this recipe?");e&&(pe.remove(),pe=!1,ui=!1),Ie.easyrecipeDialog(Xt)}function S(){var t,i=e("#inpERPaste"),n=i.val();t=y(n),(0!==t.ingredients.length||0!==t.instructions.length)&&(be=n,i.val(""),bt={name:o(a(Z.val())),author:o(r(se)),"yield":r(ae),type:o(r(le)),cuisine:o(r(oe)),summary:o(r(X)),servesize:r(Qe),prepTime:ie.val(),cookTime:ne.val()},ui=!1,Ie.easyrecipeDialog(Xt),C(null))}function N(t){var i=e(t.target).parent(),n=i.parent();i.hasClass("easyrecipeAbove")?n.before(ci):n.after(ci),i.remove(),_()}function _(){var t,i,n;i=e("<div>"+J.getContent()+"</div>"),i.find(".easyrecipeAbove,.easyrecipeBelow").remove(),t=i.find(".easyrecipe"),t.each(function(){var t=e(this);t.parent().hasClass("easyrecipeWrapper")&&t.unwrap(),yt(t)}),n=i.html(),J.setContent(n),t=Qt.find(".easyrecipe"),t.on("mousedown",null,li,k),Qt.find(".ERInsertLine").on(ei,N)}function A(e){var t,i,n,a,r;if(a=e.prev(),r=e.next(),i=0===a.length||a.hasClass("easyrecipe")||a.hasClass("easyrecipeWrapper"))try{i=!(e[0].previousSibling&&3===e[0].previousSibling.nodeType)}catch(s){}if(n=0===r.length||r.hasClass("easyrecipe")||r.hasClass("easyrecipeWrapper"))try{n=!(e[0].nextSibling&&3===e[0].nextSibling.nodeType)}catch(s){}(i||n)&&(e.wrap('<div class="easyrecipeWrapper mceNonEditable" />'),t=e.parent(),i&&(t.prepend('<div class="easyrecipeAbove mceNonEditable"><input class="ERInsertLine mceNonEditable" type="button" value="Insert line above" /></div>'),t.find("input").on(ei,N),di.push(t.find(".easyrecipeAbove")[0])),n&&(t.append('<div class="easyrecipeBelow mceNonEditable"><input class="ERInsertLine mceNonEditable" type="button" value="Insert line below" /></div>'),t.find("input").on(ei,N)))}function L(t){e(".easyrecipeAbove,.easyrecipeBelow",t).remove(),e(".easyrecipe",t).unwrap()}function D(){var t=e(".easyrecipe",Qt);0!==t.length&&(t.on("mousedown",null,li,k),_())}function P(){var t,i,n,s,l,u,p,h,f,v,m,g,y,E,b="",R="",w=0,k="",C=[];if(Ae.find(".erdeleteme").remove(),d(ie)&&d(ne)){for(i=e.trim(ie.val()),""!==i?(De=Nt.exec(i),n=De[1]?parseInt(De[1],10):0,s=De[2]?parseInt(De[2],10):0,w=60*n+s,l=n>0?n+"H":"",u=s>0?s+"M":"",R="PT"+l+u):i=!1,t=e.trim(ne.val()),""!==t?(De=Nt.exec(t),n=De[1]?parseInt(De[1],10):0,s=De[2]?parseInt(De[2],10):0,l=n>0?n+"H":"",u=s>0?s+"M":"",w+=60*n+s,b="PT"+l+u):t=!1,w>0?(n=Math.floor(w/60),s=w%60,l=n>0?n+" hour":"",n>1&&(l+="s"),u=s>0?s+" min":"",s>1&&(u+="s"),w=e.trim(l+" "+u),l=n>0?n+"H":"",u=s>0?s+"M":"",k="PT"+l+u):w=!1,p=ee.val().split("\n"),f=0;f<p.length;f++)h=p[f],""!==h&&("!"===h.charAt(0)?(v=!0,h=h.substr(1)):v=!1,C.push({ingredient:o(a(h)),hasHeading:v}));for(p=te.val().split("\n"),g=[],m={INSTRUCTIONS:[]},f=0;f<p.length;f++)h=e.trim(p[f].replace(/^[ 0-9\.]*(.*)$/gi,"$1")),""!==h&&("!"===h.charAt(0)?((m.INSTRUCTIONS.length>0||m.heading)&&g.push(m),h=h.substr(1),m={},m.INSTRUCTIONS=[],m.heading=o(a(h))):m.INSTRUCTIONS.push({instruction:o(a(h))}));(m.INSTRUCTIONS.length>0||m.heading)&&g.push(m),h=r(ot),h&&(h=h.replace(/\n/g,"[br]")),y={version:Te.version,hasPhoto:""!==oi,photoURL:oi,name:o(a(Z.val())),author:o(r(se)),preptime:i,cooktime:t,totaltime:w,preptimeISO:R,cooktimeISO:b,totaltimeISO:k,"yield":r(ae),type:o(r(le)),cuisine:o(r(oe)),summary:o(r(X)),servesize:r(Qe),calories:r(Ke),fat:r(Ze),satfat:r(Xe),unsatfat:r(et),transfat:r(tt),carbs:r(it),sugar:r(nt),sodium:r(at),fiber:r(rt),protein:r(st),cholesterol:r(lt),notes:o(h),rating:K.length?K.val():"0",INGREDIENTS:C,STEPS:g},""===y.name&&(y.name=!1),E=c(Te.recipeTemplate,y),-1===dt?pe=e(Gt,Qt):(pe=e(".easyrecipe",Qt),pe.length>0&&(pe=e(pe[dt]))),pe.before(E),pe.remove(),pe=!1,ct.css("display","inline-block"),ui=!1,Ie.easyrecipeDialog(Xt),Kt=e(".easyrecipe",Qt).length,D()}}function M(t,i,n){var a,r,s;if(bt=!1,tinymce.majorVersion>"3"){if(!re[i.id]&&"wp_mce_fullscreen"!==i.id)return e("#"+i.controlManager.buttons.easyrecipeTest._id).hide(),e("#"+i.controlManager.buttons.easyrecipeEdit._id).hide(),void e("#"+i.controlManager.buttons.easyrecipeAdd._id).hide();re[i.id]?(Qt=e("#"+i.id+"_ifr").contents(),Le=1e4,r=e("#"+i.controlManager.buttons.easyrecipeTest._id),ct=e("#"+i.controlManager.buttons.easyrecipeEdit._id)):(Qt=e("#wp_mce_fullscreen_ifr").contents(),Le=200001,r=e("#mce_fullscreen_easyrecipeTest"),ct=e("#mce_fullscreen_easyrecipeEdit"))}else{if(!re[i.editorId]&&"wp_mce_fullscreen"!==i.editorId)return e("#"+i.editorId+"_easyrecipeTest").hide(),e("#"+i.editorId+"_easyrecipeEdit").hide(),void e("#"+i.editorId+"_easyrecipeAdd").hide();re[i.editorId]?(Qt=e("#"+i.editorId+"_ifr").contents(),Le=1e4,r=e("#"+i.editorId+"_easyrecipeTest"),ct=e("#"+i.editorId+"_easyrecipeEdit")):(Qt=e("#wp_mce_fullscreen_ifr").contents(),Le=200001,r=e("#mce_fullscreen_easyrecipeTest"),ct=e("#mce_fullscreen_easyrecipeEdit"))}Ae=e("body",Qt),s=e(".easyrecipe",Qt),J=tinyMCE.activeEditor,s.each(function(){var t=e(this);t.addClass("mceNonEditable"),t.find(".ERRatingOuter").remove(),t.find(".ERHDPrint").remove(),t.find(".ERLinkback").remove(),t.find(".endeasyrecipe").attr("title")}),Kt=s.length,Kt>0&&""!==Te.testURL?r.show():r.hide(),Kt>0?ct.css("display","inline-block"):ct.hide(),Qt.hasERCSS||(a=Te.isDebug?"":"-min",e("head",Qt).append('<link rel="stylesheet" type="text/css" href="'+Te.easyrecipeURL+"/css/easyrecipe-entry"+a+".css?ver="+Te.version+'" />'),Qt.hasERCSS=!0),D()}function U(){Ye.toggleClass("ERNone"),Ve.toggleClass("ERContract")}function H(){Ge.toggleClass("ERNone"),Je.toggleClass("ERContract")}function O(t,i){var n,a,r;i&&(i=e(i),url=e.trim(i.find("#er-link-url").val()),n=e.trim(i.find("#er-link-text").val()),url&&n&&(a=i.find("#er-link-target")[0].checked?' target="_blank"':"",r='href="'+url+'"'+a,jt.push(r),Ce.val(ke.substring(0,Re)+"[url:"+jt.length+"]"+n+"[/url]"+ke.substring(we)),Ce[0].focus())),Ot=!1}function q(e){var t,i,n;Te.isEntryDialog&&(t=e.title?' title="'+e.title+'"':"",i=e.target?' target="'+e.target+'"':"",n='href="'+e.href+'"'+i+t,jt.push(n),Ce.val(ke.substring(0,Re)+"[url:"+jt.length+"]"+ke.substring(Re,we)+"[/url]"+ke.substring(we)),Ce[0].focus(),Ae.find(".erdeleteme").remove())}function j(t,i){var n,a,r,s,l,o,c,d,u,p,h,f,v,m,g;a=t.sizes[i.size],r=a.url,o=a.width,c=a.height,b(r,He.length),d=tinymce.html.Entities.encodeAllRaw(e.trim(t.title)),d=d.replace(/&quot;/g,"&amp;quot;"),u=tinymce.html.Entities.encodeAllRaw(e.trim(t.alt)),u=u.replace(/&quot;/g,"&amp;quot;"),p=tinymce.html.Entities.encodeAllRaw(e.trim(t.caption)),d=""!==d?' title="'+d+'"':"",u=""!==u?' alt="'+u+'"':"",h="align"+i.align,l=t.uploadedTo?'id="attachment_'+t.uploadedTo+'" ':"",n=ke.substring(0,Re),""!==p?(zt.push(l+'align="'+h+'" width="'+o+'"'),$t.push(p),f="[cap:"+zt.length+"]",v="[/cap]",h=""):f=v="","none"===i.link?s=m=g="":"file"===i.link?s=r:"post"===i.link?s=t.link:"custom"===i.link&&(s=i.linkUrl),""!==s&&(jt.push('href="'+s+'"'),m="[url:"+jt.length+"]",g="[/url]"),Ft.push('src="'+r+'" width="'+o+'" height="'+c+'" class="'+h+" size-"+i.size+'"'+d+u),n+=f+m+"[img:"+Ft.length+"]"+g+v,n+=ke.substring(we),Ce.val(n),Ce[0].focus()}function F(){var e;Te.isGuest?Te.doUpload():(wt||(wt=wp.media({title:"Select Image",multiple:!1,library:{type:"image"},button:{text:"add image"}}),wt.on("content:create:browse",function(t){e=t.view,t.view.options.display=!0}),wt.on("select",function(){var t=wt.state().get("selection"),i=e.sidebar.get("display").model.attributes,n=t.models[0].attributes;j(n,i)})),wt.open())}function z(t){var i,n,a,r=!1;if(t.stopPropagation(),Wt){if(Wt.focus(),Re=Wt[0].selectionStart,we=Wt[0].selectionEnd,ke=Wt.val(),n=e(this),n.hasClass("ERIconBold")?(r="[b]",a="[/b]"):n.hasClass("ERIconUnderline")?(r="[u]",a="[/u]"):n.hasClass("ERIconItalic")?(r="[i]",a="[/i]"):n.hasClass("ERIconLineBreak")&&(r="[br]",a=""),r)return(Re!==we||""===a)&&Wt.val(ke.substring(0,Re)+r+ke.substring(Re,we)+a+ke.substring(we)),void Wt[0].focus();if(n.hasClass("ERIconImage")&&(Ce=Wt,F()),n.hasClass("ERIconLink")){if(Re===we)return;Ce=Wt,Te.wpVersion<"4.2"?(Ae.find(".erdeleteme").remove(),Yt++,i=e(Te.wpVersion<"4.2"?'<div class="erdeleteme" id="ertmp_'+Yt+'">link</div>':'<p class="erdeleteme" id="ertmp_'+Yt+'">'+Ce.val().substring(Re,we)+"</p>"),i.appendTo(Ae),J.selection.select(i[0].firstChild),J.nodeChanged(),J.execCommand("WP_Link",!1)):Te.erLink.open(Ce.val().substring(Re,we)),Ot=!0}}}function $(){bt=!1,C()}function B(){bt=!1,k()}function W(){Kt>0&&!Te.noHTMLWarn&&(Te.noHTMLWarn=!0,xe.dialog(ii))}function Y(t){var i,n,a,r,s=e("#wp-preview",t.target).val();return"dopreview"===s?!0:0===Kt?!0:(a=tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden(),a?n=e("<div>"+J.getContent()+"</div>"):(r=e("#wp-content-editor-container").find("textarea"),n=e("<div>"+r.val()+"</div>")),L(e(".easyrecipeWrapper",n)),e(".easyrecipe",n).removeClass("mceNonEditable"),i=e.trim(n.html()),a?J.setContent(i):r.val(i),!0)}function V(t){var i;""!=t.target.innerHTML&&(i=e(t.target).find("img").attr("src"),i&&w(i,!1))}function G(t){var i,n,a,r;for(i=t[0],n=0;n<i.addedNodes.length;n++)if(a=e(i.addedNodes[n].innerHTML),r=a.find("img").attr("src")){w(r,!1);break}}var J,Q,K,Z,X,ee,te,ie,ne,ae,re,se,le,oe,ce,de,ue,pe,he,fe,ve,me,ge,ye,Ee,be,Re,we,ke,Ce,Te,xe,Ie,Se,Ne,_e,Ae,Le,De,Pe,Me,Ue,He,Oe,qe,je,Fe,ze,$e,Be,We,Ye,Ve,Ge,Je,Qe,Ke,Ze,Xe,et,tt,it,nt,at,rt,st,lt,ot,ct,dt,ut,pt,ht,ft,vt,mt,gt,yt,Et,bt,Rt,wt,kt=jQuery.trim,Ct=!1,Tt=/<!-- START INCLUDEIF (!?)([_a-z][_0-9a-z]{0,19}) -->/i,xt=/^#([_a-z][_0-9a-z]{0,19})#/im,It=/<!-- START REPEAT ([_a-zA-Z][_0-9a-zA-Z]{0,19}) -->/m,St=/^([^<]*)/,Nt=/^(?:([0-9]+) *(?:h|hr|hrs|hour|hours))? *(?:([0-9]+) *(?:m|mn|mns|min|mins|minute|minutes))?$/i,_t=/^([0-9]+)$/,At=/(.*)\[amd-(recipeseo|zlrecipe)-recipe:([0-9]+)](.*)/,Lt=/(.*)\[(yumprint)-recipe\s+id='(\d+)'](.*)/i,Dt=/(.*)\[(gmc)_recipe\s+([0-9]+)](.*)/,Pt=/PT(?:([0-9]*)+H)?([0-9]+)+M/i,Mt=/\[(?:img) +(?:[^\]]+?)]/gi,Ut=/class\s*=\s*"(?:[^"]+ )?photo[ "]/i,Ht=/src\s*=\s*" *([^"]+?) *"/i,Ot=!1,qt={recipeseo:"Recipe SEO",ziplist:"ZipList",zlrecipe:"ZipList",yumprint:"Yumprint Recipe Card",recipress:"ReciPress",gmc:"GetMeCooking",recipage:"ReciPage"},jt=[],Ft=[],zt=[],$t=[],Bt="Switch to the Visual Editor to add or edit an EasyRecipe",Wt=null,Yt=0,Vt='<div class="easyrecipeholder">EasyRecipe</div>',Gt=".easyrecipeholder",Jt="ERSeparator",Qt=null,Kt=0,Zt=!0,Xt="close",ei="click",ti="undefined",ii="open",ni="ERPhotoSelected",ai="http://www.easyrecipeplugin.com/checkUpdates.php",ri='<div class="divERNoPhotos">There are no photos in this post<br />Add photos anywhere in the post</div>',si=-1,li=-2,oi="",ci="&nbsp;",di=[],ui=!1;e(function(){var i,n,a,r=null;Te=EASYRECIPE,Te.dialogs=e("<div>").addClass("easyrecipeUI").prop("id","easyrecipeUI").appendTo("body"),Te.isGuest&&Te.dialogs.addClass("easyrecipeDlgAbsolute"),e.widget("custom.easyrecipeDialog",e.ui.dialog,{_allowInteraction:function(t){return this._super(t)||!!e(t.target).parents(".media-modal-content, #wp-link").length||!!e(t.target).parents("form#er-link").length}}),Te.button!==e.fn.button&&(r=e.fn.button,e.fn.button=Te.button),Ie=e("#easyrecipeEntry"),Ne=e("#easyrecipeSelect"),xe=e("#easyrecipeHTMLWarn"),re=Te.isGuest?{guestpost:1}:{content:1,aviaTBcontent:1},Ne.dialog({autoOpen:!1,width:340,modal:!0,appendTo:Te.dialogs,dialogClass:"easyrecipeSelect",close:function(){e(".easyrecipeSelect").filter(function(){return""===e(this).text()}).remove()}}),e("#divERSELContainer").show(),Ie.easyrecipeDialog({autoOpen:!1,width:655,modal:!0,appendTo:Te.dialogs,dialogClass:"easyrecipeEntry",beforeClose:function(){if(ui){if(!window.confirm("Are you sure you want to close without saving the recipe?"))return!1;ui=!1}return!0},close:function(){Te.isEntryDialog=!1,Ae.find(".erdeleteme").remove(),pe&&!he&&pe.remove(),pe=!1,e(".easyrecipeEntry").filter(function(){return""===e(this).text()}).remove()},open:function(){Te.isEntryDialog=!0,Pe.tabs({active:0,beforeActivate:t}),setTimeout(function(){var t=e(".easyrecipeEntry"),i=t.offset();i.top<ft&&(i.top=ft,t.offset(i))},250)}}),Rt=e("#divERContainer").show(),xe.dialog({autoOpen:!1,width:420,modal:!0,dialogClass:"easyrecipeHTMLWarn",appendTo:Te.dialogs,close:function(){e(".easyrecipeHTMLWarn").filter(function(){return""===e(this).text()}).remove()}}),e(".divERHTMLWarnContainer").show(),_e=e("#easyrecipeConvert"),je=e("#divERCNVSpinner"),Fe=e("#btnERCNVCancel"),ze=e("#btnERCNVOK"),je.hide(),_e.dialog({autoOpen:!1,width:390,modal:!0,dialogClass:"easyrecipeConvert",appendTo:Te.dialogs,close:function(){e(".easyrecipeConvert").filter(function(){return""===e(this).text()}).remove()}}),e("#divERCNVContainer").show(),e(window).bind("easyrecipeadd",$),e(window).bind("easyrecipeedit",B),e(window).bind("easyrecipeload",M),Ue=e("#divERNext"),Me=e("#btnERButtons"),Pe=e("#ERDTabs"),Oe=e("#divERPhotos"),e("input:submit",".easyrecipeUI").button(),fe=e("#ed_toolbar"),K=e("#inpERRating"),Z=e("#inpERName"),se=e("#inpERAuthor"),le=e("#inpERType"),oe=e("#inpERCuisine"),ce=e("#inpERTags"),X=e("textarea#taERSummary"),ee=e("textarea#taERIngredients"),te=e("textarea#taERInstructions"),ie=e("#inpERPrepTime"),ne=e("#inpERCookTime"),ae=e("#inpERYield"),Qe=e("#inpERServeSize"),Ke=e("#inpERCalories"),Ze=e("#inpERFat"),Xe=e("#inpERSatFat"),et=e("#inpERUnsatFat"),tt=e("#inpERTransFat"),it=e("#inpERCarbs"),nt=e("#inpERSugar"),at=e("#inpERSodium"),rt=e("#inpERFiber"),st=e("#inpERProtein"),lt=e("#inpERCholesterol"),ot=e("textarea#taERNotes"),ut=e("#divERAddImageURL"),a=e("#lnkERPhotoURL"),de=e(".ERTimeError"),$e=e("#divERAdd"),Be=e("#divERChange"),We=e("#divERHeader"),Ye=e("#divEROther"),Ve=e("#divEROtherLabel"),Ge=e("#divERNotes"),Je=e("#divERNotesLabel"),qe=e("#ERDPasteTab"),pt=e("#fldERAPUImageURL"),e("#btnERAdd").click(P),e("#btnERNext").click(s),e("#btnERChange").click(P),e("#btnERDelete").click(I),e("#btnERCancel").click(T),a.click(function(){ut.show(500)}),e("#btnERAIUCancel").click(function(){ut.hide()}),e("#btnERAIUOK").click(R),Ve.click(U),Je.click(H),ie.change(function(t){d(e(t.target))}),ne.change(function(t){d(e(t.target))}),e("#btnERPaste").click(S),e("#btnERSELCancel").click(x),ft=e("#wpadminbar").height(),vt=e("#divEREditBtns").on("mousedown","li",z),Rt.find('input[type="text"], textarea').on("blur",function(){Wt=null}).on("focus",function(){Wt=e(this)}),Te.wpVersion<"4.2"?Te.insertLink=q:e(document).bind("erlink-close",O),ye=C,Ee=k,be=!1,Te.insertUploadedImage=j,yt=A,Et=b,Te.addListener=D,xe.find("input").on(ei,function(){xe.dialog(Xt)}),e("#wp-content-editor-tools").on(ei,"#content-html",W),e("#post").on("submit",Y),null!==r&&(e.fn.button=r),i=e("#postimagediv").find(".inside"),window.MutationObserver&&i.length>0?(n=new MutationObserver(G),n.observe(i[0],{childList:!0})):i.on("DOMSubtreeModified",V),window.QTags&&QTags.addButton("easyrecipe","EasyRecipe",function(){alert(Bt)},"","","",900)})}(jQuery),/*! EasyRecipe Plus 3.3.3077 Copyright (c) 2015 BoxHill LLC */
window.EASYRECIPE=window.EASYRECIPE||{},function(e){"use strict";var t,i,n,a,r,s,l={},o={},c="ontouchend"in document;t={timeToTriggerRiver:150,minRiverAJAXDuration:200,riverBottomThreshold:5,keySensitivity:100,lastSearch:"",textarea:"",rename:function(i){i.each(function(){var i,n=e(this),a=this,r=n.children();r.length>0&&t.rename(r),a.id&&(i=a.id.match(/^wp-link(.*)$/),a.id=null!=i?"er-link"+i[1]:"er-"+a.id)})},init:function(){function a(){var t=e.trim(l.url.val());t&&r!==t&&!/^(?:[a-z]+:|#|\?|\.|\/)/.test(t)&&(l.url.val("http://"+t),r=t)}var c,d,u;s=EASYRECIPE,s.erLink=t,u=e("#wp-link-wrap"),c=u.clone(),t.rename(c),c.find("#search-results").attr("id","#er-search-results"),c.find("#most-recent-results").attr("id","#er-most-recent-results"),c.find("#query-notice-message").attr("id","#er-query-notice-message"),u.after(c),d=e("#wp-link-backdrop").clone(),d[0].id="er-link-backdrop",c.before(d),e("#easyrecipeUI").find(".ui-dialog.easyrecipeEntry").on("focusin",function(){l.url.focus()}),l.wrap=c,l.dialog=e("#er-link"),l.backdrop=d,l.submit=e("#er-link-submit"),l.close=e("#er-link-close"),l.text=e("#er-link-text"),l.url=e("#er-link-url"),l.nonce=e("#_ajax_linking_nonce"),l.openInNewTab=e("#er-link-target"),l.search=e("#er-link-search"),o.search=new n(e("#er-search-results")),o.recent=new n(e("#er-most-recent-results")),o.elements=l.dialog.find(".query-results"),l.queryNotice=e("#er-query-notice-message"),l.queryNoticeTextDefault=l.queryNotice.find(".query-notice-default"),l.queryNoticeTextHint=l.queryNotice.find(".query-notice-hint"),l.dialog.keydown(t.keydown),l.dialog.keyup(t.keyup),l.submit.click(function(e){e.preventDefault(),t.close(l.wrap)}),l.close.add(l.backdrop).add("#er-link-cancel a").click(function(e){e.preventDefault(),t.close()}),e("#er-link-search-toggle").on("click",t.toggleInternalLinking),o.elements.on("river-select",t.updateFields),l.search.on("focus.erlink",function(){l.queryNoticeTextDefault.hide(),l.queryNoticeTextHint.removeClass("screen-reader-text").show()}).on("blur.erlink",function(){l.queryNoticeTextDefault.show(),l.queryNoticeTextHint.addClass("screen-reader-text").hide()}),l.search.keyup(function(){var e=this;window.clearTimeout(i),i=window.setTimeout(function(){t.searchInternalLinks.call(e)},500)}),l.url.on("paste",function(){setTimeout(a,0)}),l.url.on("blur",a)},open:function(i){e(document.body).addClass("modal-open"),t.range=null,l.wrap.show(),l.backdrop.show(),o.search.refresh(),o.recent.refresh(),o.recent.ul.children().length||o.recent.ajax(),r="",l.url.val(r),l.submit.val(wpLinkL10n.update),l.text.val(i||""),l.wrap.addClass("has-text-field"),e(document).trigger("erlink-open",l.wrap),c?l.url.focus().blur():l.url.focus()[0].select()},close:function(t){e(document.body).removeClass("modal-open"),l.backdrop.hide(),l.wrap.hide(),r=!1,e(document).trigger("erlink-close",t)},updateFields:function(e,t){l.url.val(t.children(".item-permalink").val())},searchInternalLinks:function(){var i,n=e(this),a=n.val();if(a.length>2){if(o.recent.hide(),o.search.show(),t.lastSearch==a)return;t.lastSearch=a,i=n.parent().find(".spinner").addClass("is-active"),o.search.change(a),o.search.ajax(function(){i.removeClass("is-active")})}else o.search.hide(),o.recent.show()},next:function(){o.search.next(),o.recent.next()},prev:function(){o.search.prev(),o.recent.prev()},keydown:function(i){var n,a,r=e.ui.keyCode;r.ESCAPE===i.keyCode?(t.close(),i.stopImmediatePropagation()):r.TAB===i.keyCode&&(a=i.target.id,"er-link-submit"!==a||i.shiftKey?"er-link-close"===a&&i.shiftKey&&(l.submit.focus(),i.preventDefault()):(l.close.focus(),i.preventDefault())),(i.keyCode===r.UP||i.keyCode===r.DOWN)&&(!document.activeElement||"er-link-title-field"!==document.activeElement.id&&"er-url-field"!==document.activeElement.id)&&(n=i.keyCode===r.UP?"prev":"next",clearInterval(t.keyInterval),t[n](),t.keyInterval=setInterval(t[n],t.keySensitivity),i.preventDefault())},keyup:function(i){var n=e.ui.keyCode;(i.which===n.UP||i.which===n.DOWN)&&(clearInterval(t.keyInterval),i.preventDefault())},delayedCallback:function(e,t){var i,n,a,r;return t?(setTimeout(function(){return n?e.apply(r,a):void(i=!0)},t),function(){return i?e.apply(this,arguments):(a=arguments,r=this,void(n=!0))}):e},toggleInternalLinking:function(e){var t=l.wrap.hasClass("search-panel-visible");l.wrap.toggleClass("search-panel-visible",!t),setUserSetting("wplink",t?"0":"1"),l[t?"url":"search"].focus(),e.preventDefault()}},n=function(t,i){var n=this;this.element=t,this.ul=t.children("ul"),this.contentHeight=t.children("#er-link-selector-height"),this.waiting=t.find(".river-waiting"),this.change(i),this.refresh(),e("#er-link .query-results, #er-link #er-link-selector").scroll(function(){n.maybeLoad()}),t.on("click","li",function(t){n.select(e(this),t)})},e.extend(n.prototype,{refresh:function(){this.deselect(),this.visible=this.element.is(":visible")},show:function(){this.visible||(this.deselect(),this.element.show(),this.visible=!0)},hide:function(){this.element.hide(),this.visible=!1},select:function(e,t){var i,n,a,r;e.hasClass("unselectable")||e==this.selected||(this.deselect(),this.selected=e.addClass("selected"),i=e.outerHeight(),n=this.element.height(),a=e.position().top,r=this.element.scrollTop(),0>a?this.element.scrollTop(r+a):a+i>n&&this.element.scrollTop(r+a-n+i),this.element.trigger("river-select",[e,t,this]))},deselect:function(){this.selected&&this.selected.removeClass("selected"),this.selected=!1},prev:function(){var e;this.visible&&this.selected&&(e=this.selected.prev("li"),e.length&&this.select(e))},next:function(){var t;this.visible&&(t=this.selected?this.selected.next("li"):e("li:not(.unselectable):first",this.element),t.length&&this.select(t))},ajax:function(e){var i=this,n=1==this.query.page?0:t.minRiverAJAXDuration,a=t.delayedCallback(function(t,n){i.process(t,n),e&&e(t,n)},n);this.query.ajax(a)},change:function(e){this.query&&this._search==e||(this._search=e,this.query=new a(e),this.element.scrollTop(0))},process:function(t,i){var n="",a=!0,r="",s=1==i.page;t?e.each(t,function(){r=a?"alternate":"",r+=this.title?"":" no-title",n+=r?'<li class="'+r+'">':"<li>",n+='<input type="hidden" class="item-permalink" value="'+this.permalink+'" />',n+='<span class="item-title">',n+=this.title?this.title:wpLinkL10n.noTitle,n+='</span><span class="item-info">'+this.info+"</span></li>",a=!a}):s&&(n+='<li class="unselectable no-matches-found"><span class="item-title"><em>'+wpLinkL10n.noMatchesFound+"</em></span></li>"),this.ul[s?"html":"append"](n)},maybeLoad:function(){var e=this,i=this.element,n=i.scrollTop()+i.height();!this.query.ready()||n<this.contentHeight.height()-t.riverBottomThreshold||setTimeout(function(){var n=i.scrollTop(),a=n+i.height();!e.query.ready()||a<e.contentHeight.height()-t.riverBottomThreshold||(e.waiting.addClass("is-active"),i.scrollTop(n+e.waiting.outerHeight()),e.ajax(function(){e.waiting.removeClass("is-active")}))},t.timeToTriggerRiver)}}),a=function(e){this.page=1,this.allLoaded=!1,this.querying=!1,this.search=e},e.extend(a.prototype,{ready:function(){return!(this.querying||this.allLoaded)},ajax:function(t){var i=this,n={action:"wp-link-ajax",page:this.page,_ajax_linking_nonce:l.nonce.val()};this.search&&(n.search=this.search),this.querying=!0,e.post(ajaxurl,n,function(e){i.page++,i.querying=!1,i.allLoaded=!e,t(e,n)},"json")}}),e(document).ready(t.init)}(jQuery);